---
title: "è‡ªä½œPythonãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦MCPã‚µãƒ¼ãƒãƒ¼ã‚’ä½œæˆã—ã¦ã¿ãŸ"
emoji: "ğŸ¢"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["python", "mcp", "claude", "docker", "japanese"]
published: true
published_at: "2025-06-12 07:00"
---

# ã¯ã˜ã‚ã«

ä»Šå›ã€MCPã«æ…£ã‚Œã‚‹ãŸã‚ã«è‡ªä½œãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’åˆ©ç”¨ã—ã¦Pythonã§MCPã‚µãƒ¼ãƒãƒ¼ã‚’ä½œæˆã—ã¦ã¿ã¾ã—ãŸã€‚
ä½¿ç”¨ã—ãŸè‡ªä½œãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯æ¼¢å­—ã®å¤‰æ›ã‚’è¡Œã†[kanjiconv](https://github.com/sea-turt1e/kanjiconv)ã¨ã„ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚  
ã“ã‚Œã‚’MCPã‚µãƒ¼ãƒãƒ¼ã¨ã—ã¦å®Ÿè£…ã—ã€Claude Desktopã‹ã‚‰åˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚
kanjiconvã®Zennè¨˜äº‹ã¯[ã“ã¡ã‚‰](https://zenn.dev/sea_turt1e/articles/e7dc022231a86c)ã§ã™ã€‚

## MCPã¨ã¯ï¼Ÿ

MCPï¼ˆModel Context Protocolï¼‰ã¯ã€AI ãƒ¢ãƒ‡ãƒ«ãŒå¤–éƒ¨ãƒ„ãƒ¼ãƒ«ã‚„ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã¨å®‰å…¨ã«ã‚„ã‚Šå–ã‚Šã™ã‚‹ãŸã‚ã®ã‚ªãƒ¼ãƒ—ãƒ³ãªæ¨™æº–ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã™ã€‚è©³ç´°ã¯ã„ã‚ã„ã‚ãªã¨ã“ã‚ã§è¨˜äº‹ã«ãªã£ã¦ã„ã‚‹ã®ã§ã€ã“ã“ã§ã¯å‰²æ„›ã—ã¾ã™ãŒã€MCPã‚’ä½¿ã†ã“ã¨ã§ã€AIãƒ¢ãƒ‡ãƒ«ã«å¯¾ã—ã¦ç‰¹å®šã®æ©Ÿèƒ½ã‚’æä¾›ã™ã‚‹ãƒ„ãƒ¼ãƒ«ã‚’ç°¡å˜ã«è¿½åŠ ã§ãã¾ã™ã€‚

## ä½œæˆã—ãŸã‚‚ã®

GitHubã®ãƒªãƒã‚¸ãƒˆãƒªã¯ä»¥ä¸‹ã«ãªã‚Šã¾ã™ã€‚
https://github.com/sea-turt1e/kanjiconv_mcp

ä»Šå›ä½œæˆã—ãŸ`kanjiconv_mcp`ã¯ã€ä»¥ä¸‹ã®æ©Ÿèƒ½ã‚’æä¾›ã—ã¾ã™ï¼š

- **æ¼¢å­—â†’ã²ã‚‰ãŒãªå¤‰æ›**: ã€Œå¹½â˜†éŠâ˜†ç™½æ›¸ã¯æœ€é«˜ã®æ¼«ç”»ã§ã™ã€â†’ã€Œã‚†ã†ã‚†ã†ã¯ãã—ã‚‡ã¯ã•ã„ã“ã†ã®ã¾ã‚“ãŒã§ã™ã€
- **æ¼¢å­—â†’ã‚«ã‚¿ã‚«ãƒŠå¤‰æ›**: ã€Œå¹½â˜†éŠâ˜†ç™½æ›¸ã¯æœ€é«˜ã®æ¼«ç”»ã§ã™ã€â†’ã€Œãƒ¦ã‚¦ãƒ¦ã‚¦ãƒã‚¯ã‚·ãƒ§ãƒã‚µã‚¤ã‚³ã‚¦ãƒãƒãƒ³ã‚¬ãƒ‡ã‚¹ã€
- **æ¼¢å­—â†’ãƒ­ãƒ¼ãƒå­—å¤‰æ›**: ã€Œå¹½â˜†éŠâ˜†ç™½æ›¸ã¯æœ€é«˜ã®æ¼«ç”»ã§ã™ã€â†’ã€Œyuuyuuhakushohasaiikounomangadesuã€

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

- **Python 3.13**: Pythonç’°å¢ƒ
- **uv**: é«˜é€ŸãªPython ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼
- **kanjiconv**: æ—¥æœ¬èªå¤‰æ›ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
- **sudachipy**: å½¢æ…‹ç´ è§£æã‚¨ãƒ³ã‚¸ãƒ³
- **Docker**: ã‚³ãƒ³ãƒ†ãƒŠåŒ–ã«ã‚ˆã‚‹ç’°å¢ƒã®çµ±ä¸€
- **MCP SDK**: Claude Desktopã¨ã®é€£æº

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

```
kanjiconv_mcp/
â”œâ”€â”€ main.py                    # MCPã‚µãƒ¼ãƒãƒ¼ã®ãƒ¡ã‚¤ãƒ³å®Ÿè£…
â”œâ”€â”€ pyproject.toml            # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®šã¨dependencies
â”œâ”€â”€ requirements.txt          # pipç”¨ã®ä¾å­˜é–¢ä¿‚ãƒªã‚¹ãƒˆ
â”œâ”€â”€ Dockerfile               # uvä½¿ç”¨ç‰ˆ
â”œâ”€â”€ Dockerfile.pip           # pipä½¿ç”¨ç‰ˆï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰
â”œâ”€â”€ docker-compose.yml       # ã‚µãƒ¼ãƒ“ã‚¹ç®¡ç†ç”¨
â”œâ”€â”€ docker.sh               # Dockeræ“ä½œç”¨ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ claude_desktop_config.json    # Claude Desktopè¨­å®šä¾‹
|â”€â”€ claude_desktop_config_docker.json # Dockerç‰ˆã®è¨­å®šä¾‹
â””â”€â”€ test_client.py          # ãƒ†ã‚¹ãƒˆç”¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
```

## å®Ÿè£…ã®ãƒã‚¤ãƒ³ãƒˆ

### 1. MCPã‚µãƒ¼ãƒãƒ¼ã®åŸºæœ¬æ§‹é€ 

```python
from mcp.server import Server
from mcp.server.stdio import stdio_server
from mcp.types import TextContent, Tool

# MCPã‚µãƒ¼ãƒãƒ¼ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆ
server = Server("kanjiconv-mcp")

@server.list_tools()
async def list_tools() -> list[Tool]:
    """åˆ©ç”¨å¯èƒ½ãªãƒ„ãƒ¼ãƒ«ã®ãƒªã‚¹ãƒˆã‚’è¿”ã™"""
    return [
        Tool(
            name="convert_to_hiragana",
            description="Convert Japanese text (including kanji) to hiragana",
            inputSchema={
                "type": "object",
                "properties": {
                    "text": {"type": "string", "description": "Japanese text to convert"},
                    "separator": {"type": "string", "default": "/"},
                    # ... ãã®ä»–ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³
                },
                "required": ["text"],
            },
        ),
        # ... ä»–ã®ãƒ„ãƒ¼ãƒ«
    ]

@server.call_tool()
async def call_tool(name: str, arguments: dict) -> list[TextContent]:
    """ãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—ã®å‡¦ç†"""
    if name == "convert_to_hiragana":
        request = ConvertRequest(**arguments)
        kanji_conv = get_kanji_conv_instance(
            request.separator, 
            request.use_custom_readings, 
            request.use_unidic, 
            request.sudachi_dict_type
        )
        result = kanji_conv.to_hiragana(request.text)
        return [TextContent(type="text", text=result)]
```

### 2. æŸ”è»Ÿãªè¨­å®šã‚ªãƒ—ã‚·ãƒ§ãƒ³

å„å¤‰æ›ãƒ„ãƒ¼ãƒ«ã§ã¯ä»¥ä¸‹ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ï¼š

- `separator`: å˜èªé–“ã®åŒºåˆ‡ã‚Šæ–‡å­—ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: "/"ï¼‰
- `use_custom_readings`: ã‚«ã‚¹ã‚¿ãƒ èª­ã¿è¾æ›¸ã®ä½¿ç”¨
- `use_unidic`: UniDicã®ä½¿ç”¨ï¼ˆç²¾åº¦å‘ä¸Šï¼‰
- `sudachi_dict_type`: Sudachiè¾æ›¸ã‚¿ã‚¤ãƒ—ï¼ˆfull/small/coreï¼‰

### 3. DockeråŒ–ã«ã‚ˆã‚‹ç’°å¢ƒçµ±ä¸€

#### ãƒ¡ã‚¤ãƒ³ã®Dockerfileï¼ˆuvä½¿ç”¨ï¼‰

```dockerfile
FROM python:3.13-slim-bookworm
COPY --from=ghcr.io/astral-sh/uv:latest /uv /uvx /bin/

# ã‚·ã‚¹ãƒ†ãƒ ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
RUN apt-get update && apt-get install -y \
    curl \
    build-essential \
    pkg-config \
    && rm -rf /var/lib/apt/lists/*

# Rustã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
RUN curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y \
    && . /root/.cargo/env
ENV PATH="/root/.cargo/bin:$PATH"

ADD . /app

# uvã®è¨­å®š
WORKDIR /app
RUN uv sync --locked

# è¾æ›¸ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
RUN uv run python -m unidic download

COPY main.py ./

EXPOSE 8000

# ç’°å¢ƒå¤‰æ•°ã®è¨­å®š
ENV PYTHONUNBUFFERED=1
ENV PYTHONDONTWRITEBYTECODE=1

# MCPã‚µãƒ¼ãƒãƒ¼ã®å®Ÿè¡Œ
CMD ["uv", "run", "python", "main.py"]
```

#### ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ç”¨Dockerfileï¼ˆpipä½¿ç”¨ï¼‰

```dockerfile
FROM python:3.13-slim-bookworm

RUN apt-get update && apt-get install -y \
    curl \
    build-essential \
    pkg-config \
    git \
    && rm -rf /var/lib/apt/lists/*

RUN curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y
ENV PATH="/root/.cargo/bin:$PATH"

WORKDIR /app

COPY requirements.txt ./

RUN pip install --upgrade pip \
    && pip install --no-cache-dir -r requirements.txt

RUN python -m unidic download

COPY main.py ./
COPY pyproject.toml ./

EXPOSE 8000

ENV PYTHONUNBUFFERED=1
ENV PYTHONDONTWRITEBYTECODE=1

CMD ["python", "main.py"]
```

### 4. ä¾¿åˆ©ãªãƒ˜ãƒ«ãƒ‘ãƒ¼ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

`docker.sh`ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ Dockeræ“ä½œã‚’ç°¡ç´ åŒ–ï¼š

```bash
# ãƒ“ãƒ«ãƒ‰ï¼ˆuvã‚’è©¦ã—ã¦ã‹ã‚‰pipã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰
./docker.sh build

# æ˜ç¤ºçš„ã«pipç‰ˆã§ãƒ“ãƒ«ãƒ‰
./docker.sh build-pip

# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
./docker.sh test

# ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
./docker.sh clean
```

## Claude Desktopã§ã®è¨­å®š
ä»¥ä¸‹ã®ã‚ˆã†ã«`claude_desktop_config.json`ã‚’è¨­å®šã™ã‚‹ã“ã¨ã§ã€Claude Desktopã§MCPã‚µãƒ¼ãƒãƒ¼ã‚’åˆ©ç”¨ã§ãã¾ã™ã€‚ï¼ˆç­†è€…ã¯Macç’°å¢ƒã§å®Ÿè¡Œã—ã¾ã—ãŸï¼‰

### ãƒ‡ãƒ¢
![ãƒ‡ãƒ¢å‹•ç”»](/images/kanjiconv_mcp.gif)

### ãƒ­ãƒ¼ã‚«ãƒ«å®Ÿè¡Œç‰ˆ

```json
{
  "mcpServers": {
    "kanjiconv": {
      "command": "uv",
      "args": [
        "--directory",
        "/path/to/kanjiconv_mcp",
        "run",
        "python",
        "main.py"
      ]
    }
  }
}
```

### Dockerç‰ˆ

```json
{
  "mcpServers": {
    "kanjiconv": {
      "command": "docker",
      "args": ["run", "--rm", "-i", "kanjiconv-mcp:latest"],
      "cwd": "/path/to/kanjiconv_mcp"
    }
  }
}
```

## é–‹ç™ºã§è‹¦åŠ´ã—ãŸç‚¹

### 1. Rustä¾å­˜é–¢ä¿‚ã®å•é¡Œ

`sudachipy`ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯Rustã§æ›¸ã‹ã‚ŒãŸéƒ¨åˆ†ã‚’å«ã‚€ãŸã‚ã€Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã®ãƒ“ãƒ«ãƒ‰ãŒè¤‡é›‘ã§ã—ãŸã€‚Rustã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨ç’°å¢ƒå¤‰æ•°ã®è¨­å®šãŒå¿…è¦ã§ã—ãŸã€‚

### 2. uvã¨pipã®ä½¿ã„åˆ†ã‘

æœ€æ–°ã®`uv`ã¯é«˜é€Ÿã§ã™ãŒã€ç’°å¢ƒã«ã‚ˆã£ã¦ã¯ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ãªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ãã®ãŸã‚ã€ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½ä»˜ãã®ãƒ“ãƒ«ãƒ‰ã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã—ã¾ã—ãŸã€‚

## å®Ÿéš›ã®ä½¿ç”¨ä¾‹

Claude Desktopã§ä»¥ä¸‹ã®ã‚ˆã†ãªè³ªå•ãŒã§ãã¾ã™ï¼š

```
ã€Œä»Šæ—¥ã¯è‰¯ã„å¤©æ°—ã§ã™ã­ã€ã‚’ãƒˆãƒ¼ã‚¯ãƒ³ã”ã¨ã«"/"ã§åŒºåˆ‡ã£ã¦ã€ã²ã‚‰ãŒãªã«å¤‰æ›ã—ã¦ãã ã•ã„ã€‚

â†’ ã€Œãã‚‡ã†/ã¯/ã‚ˆ/ã„/ã¦ã‚“ã/ã§ã™/ã­ã€
```

```
ã€Œãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã€ã‚’ã‚«ã‚¿ã‚«ãƒŠã«å¤‰æ›ã—ã¦ãã ã•ã„ã€‚

â†’ ã€Œãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°/ã‚²ãƒ³ã‚´ã€
```

```
ã€Œæ—¥æœ¬èªå‡¦ç†ã€ã‚’ãƒ­ãƒ¼ãƒå­—ã«å¤‰æ›ã—ã¦ãã ã•ã„ã€‚

â†’ ã€Œnihongo/shoriã€
```

## ã¾ã¨ã‚
ä»Šå›ã€è‡ªä½œPythonãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦MCPã‚µãƒ¼ãƒãƒ¼ã‚’æ§‹ç¯‰ã—ã¾ã—ãŸã€‚
ã“ã†ã„ã£ãŸè‡ªä½œã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’LLMã¨é€£æºã•ã›ãŸã„ã¨ãã«æ€ã£ãŸä»¥ä¸Šã«ç°¡å˜ã«å®Ÿè£…ã§ãã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚
MCPã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ã€AIãƒ¢ãƒ‡ãƒ«ã«ç‰¹å®šã®æ©Ÿèƒ½ã‚’ç°¡å˜ã«è¿½åŠ ã§ãã‚‹ãŸã‚ã€ä»Šå¾Œã‚‚ã•ã¾ã–ã¾ãªãƒ„ãƒ¼ãƒ«ã‚’é–‹ç™ºã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚

